geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.68, label="Tetanus at Birth", color = "black")+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 14))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black")+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 14))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black")+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 14)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 5)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 4)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =5)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 4.5)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggsave("Figures/FourAntigens/Figure1A.png")
ggplot(data = overall_sero_sf_adm1_gather_type_spread_spread, aes(x = Age, y = fit, color = Antigen))+
facet_wrap(~NAME_1, nrow =4)+
geom_ribbon(aes(ymin = LC, ymax = UC), fill = "lightgrey")+
geom_line()+
geom_point()+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella", "Tetanus"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 16),
axis.title = element_text(size = 12),
text = element_text(size = 10))
ggplot(data = overall_sero_sf_adm1_gather_type_spread_spread, aes(x = Age, y = fit, color = Antigen))+
facet_wrap(~NAME_1, nrow =4)+
geom_ribbon(aes(ymin = LC, ymax = UC), fill = "lightgrey")+
geom_line()+
geom_point()+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella", "Tetanus"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 14))
ggplot(data = overall_sero_sf_adm1_gather_type_spread_spread, aes(x = Age, y = fit, color = Antigen))+
facet_wrap(~NAME_1, nrow =4)+
geom_ribbon(aes(ymin = LC, ymax = UC), fill = "lightgrey")+
geom_line()+
geom_point()+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella", "Tetanus"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
strip.text.x = element_text(size = 16),
text = element_text(size = 14))
grid.arrange(text.r, text.m, text.d,
text.1, text.2,
rub_0_1+ theme(legend.position = "none"), rub_1_2 + theme(legend.position = "none"), rub_2_3+ theme(legend.position = "none"),
rub_3_6+ theme(legend.position = "none"), rub_6_10+ theme(legend.position = "none"), rub_10_15+ theme(legend.position = "none"),
text.3,
mea_0_1+ theme(legend.position = "none"), mea_1_2 + theme(legend.position = "none"), mea_2_3+ theme(legend.position = "none"),
mea_3_6+ theme(legend.position = "none"), mea_6_10+ theme(legend.position = "none"), mea_10_15+ theme(legend.position = "none"),
text.35,
dip_0_1+ theme(legend.position = "none"), dip_1_2 + theme(legend.position = "none"), dip_2_3+ theme(legend.position = "none"),
dip_3_6+ theme(legend.position = "none"), dip_6_10+ theme(legend.position = "none"), dip_10_15+ theme(legend.position = "none"),
text.69,
text.1014,
legend_plot,
layout_matrix = rbind(c(NA, 1, 2, 3),
c(4, 6, 13, 20),
c(5, 7, 14, 21),
c(12, 8, 15, 22),
c(19, 9, 16, 23),
c(26, 10, 17, 24),
c(27, 11, 18, 25)),
top = textGrob("Estimated Proportion of Population with Antibodies To", gp=gpar(fontsize = 18)))
library(ggpubr)
grid.arrange(text.r, text.m, text.d,
text.1, text.2,
rub_0_1+ theme(legend.position = "none"), rub_1_2 + theme(legend.position = "none"), rub_2_3+ theme(legend.position = "none"),
rub_3_6+ theme(legend.position = "none"), rub_6_10+ theme(legend.position = "none"), rub_10_15+ theme(legend.position = "none"),
text.3,
mea_0_1+ theme(legend.position = "none"), mea_1_2 + theme(legend.position = "none"), mea_2_3+ theme(legend.position = "none"),
mea_3_6+ theme(legend.position = "none"), mea_6_10+ theme(legend.position = "none"), mea_10_15+ theme(legend.position = "none"),
text.35,
dip_0_1+ theme(legend.position = "none"), dip_1_2 + theme(legend.position = "none"), dip_2_3+ theme(legend.position = "none"),
dip_3_6+ theme(legend.position = "none"), dip_6_10+ theme(legend.position = "none"), dip_10_15+ theme(legend.position = "none"),
text.69,
text.1014,
legend_plot,
layout_matrix = rbind(c(NA, 1, 2, 3),
c(4, 6, 13, 20),
c(5, 7, 14, 21),
c(12, 8, 15, 22),
c(19, 9, 16, 23),
c(26, 10, 17, 24),
c(27, 11, 18, 25)),
top = textGrob("Estimated Proportion of Population with Antibodies To", gp=gpar(fontsize = 18)))
library(grid)
grid.arrange(text.r, text.m, text.d,
text.1, text.2,
rub_0_1+ theme(legend.position = "none"), rub_1_2 + theme(legend.position = "none"), rub_2_3+ theme(legend.position = "none"),
rub_3_6+ theme(legend.position = "none"), rub_6_10+ theme(legend.position = "none"), rub_10_15+ theme(legend.position = "none"),
text.3,
mea_0_1+ theme(legend.position = "none"), mea_1_2 + theme(legend.position = "none"), mea_2_3+ theme(legend.position = "none"),
mea_3_6+ theme(legend.position = "none"), mea_6_10+ theme(legend.position = "none"), mea_10_15+ theme(legend.position = "none"),
text.35,
dip_0_1+ theme(legend.position = "none"), dip_1_2 + theme(legend.position = "none"), dip_2_3+ theme(legend.position = "none"),
dip_3_6+ theme(legend.position = "none"), dip_6_10+ theme(legend.position = "none"), dip_10_15+ theme(legend.position = "none"),
text.69,
text.1014,
legend_plot,
layout_matrix = rbind(c(NA, 1, 2, 3),
c(4, 6, 13, 20),
c(5, 7, 14, 21),
c(12, 8, 15, 22),
c(19, 9, 16, 23),
c(26, 10, 17, 24),
c(27, 11, 18, 25)),
top = textGrob("Estimated Proportion of Population with Antibodies To", gp=gpar(fontsize = 18)))
library(gridExtra)
grid.arrange(text.r, text.m, text.d,
text.1, text.2,
rub_0_1+ theme(legend.position = "none"), rub_1_2 + theme(legend.position = "none"), rub_2_3+ theme(legend.position = "none"),
rub_3_6+ theme(legend.position = "none"), rub_6_10+ theme(legend.position = "none"), rub_10_15+ theme(legend.position = "none"),
text.3,
mea_0_1+ theme(legend.position = "none"), mea_1_2 + theme(legend.position = "none"), mea_2_3+ theme(legend.position = "none"),
mea_3_6+ theme(legend.position = "none"), mea_6_10+ theme(legend.position = "none"), mea_10_15+ theme(legend.position = "none"),
text.35,
dip_0_1+ theme(legend.position = "none"), dip_1_2 + theme(legend.position = "none"), dip_2_3+ theme(legend.position = "none"),
dip_3_6+ theme(legend.position = "none"), dip_6_10+ theme(legend.position = "none"), dip_10_15+ theme(legend.position = "none"),
text.69,
text.1014,
legend_plot,
layout_matrix = rbind(c(NA, 1, 2, 3),
c(4, 6, 13, 20),
c(5, 7, 14, 21),
c(12, 8, 15, 22),
c(19, 9, 16, 23),
c(26, 10, 17, 24),
c(27, 11, 18, 25)),
top = textGrob("Estimated Proportion of Population with Antibodies To", gp=gpar(fontsize = 18)))
text.r
rub_0_1
grid.arrange(text.r, text.m, text.d,
text.1, text.2,
rub_0_1+ theme(legend.position = "none"), rub_1_2 + theme(legend.position = "none"), rub_2_3+ theme(legend.position = "none"),
rub_3_6+ theme(legend.position = "none"), rub_6_10+ theme(legend.position = "none"), rub_10_15+ theme(legend.position = "none"),
text.3,
mea_0_1+ theme(legend.position = "none"), mea_1_2 + theme(legend.position = "none"), mea_2_3+ theme(legend.position = "none"),
mea_3_6+ theme(legend.position = "none"), mea_6_10+ theme(legend.position = "none"), mea_10_15+ theme(legend.position = "none"),
text.35,
dip_0_1+ theme(legend.position = "none"), dip_1_2 + theme(legend.position = "none"), dip_2_3+ theme(legend.position = "none"),
dip_3_6+ theme(legend.position = "none"), dip_6_10+ theme(legend.position = "none"), dip_10_15+ theme(legend.position = "none"),
text.69,
text.1014,
legend_plot,
layout_matrix = rbind(c(NA, 1, 2, 3, NA),
c(4, 6, 13, 20, NA),
c(5, 7, 14, 21, NA),
c(12, 8, 15, 22, 28),
c(19, 9, 16, 23, NA),
c(26, 10, 17, 24, NA),
c(27, 11, 18, 25, NA)),
top = textGrob("Estimated Proportion of Population with Antibodies To", gp=gpar(fontsize = 18)))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =7)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 4.5)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =8)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 4.5)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =10)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 4.5)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggplot(data = overall_sero_sf_gather_type_spread_spread_1, aes(x = Age, y = fit, fill = Antigen))+
geom_ribbon(aes(ymin = LC, ymax = UC), alpha =0.6)+
geom_line(aes(color = Antigen))+
geom_point(data = tet_dot, aes(x=Age, y=fit), size =11)+
annotate(geom = "text", x = 4, y = 0.67, label="Tetanus at Birth", color = "black", size = 4.5)+
theme_bw()+
xlab("Age")+
ylab("Seroprevalence")+
scale_color_discrete(name = "Antigen",
labels = c("Diphtheria", "Measles", "Rubella"))+
scale_x_continuous(expand = c(0,0), limits = c(0, NA))+
guides(size = "none", fill = "none")+
scale_y_continuous(limits = c(0.1, 1))+
ggtitle("Seroprevalence All Ages")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
axis.title = element_text(size = 16),
text = element_text(size = 15))
ggsave("Figures/FourAntigens/Figure1A.png")
View(spatial_nigeria_Sf)
plot
plot(spatial_nigeria_Sf)
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_fixed() +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank(),
legend.title = element_text(size = 14),
legend.text = element_text(size = 10))
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf() +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank(),
legend.title = element_text(size = 14),
legend.text = element_text(size = 10))
View(spatial_nigeria_Sf)
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf()
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf(xlim = c(2, 15))
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf(xlim = c(2, 15),
ylim = c(4, 14))
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf(xlim = c(2, 15),
ylim = c(4, 14))+
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank(),
legend.title = element_text(size = 14),
legend.text = element_text(size = 10))
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf(xlim = c(2, 15),
ylim = c(4, 14))+
ggtitle("DHS Clusters")+
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank(),
legend.title = element_text(size = 14),
legend.text = element_text(size = 10))
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = spatial_nigeria_Sf)+
coord_sf(xlim = c(2, 15),
ylim = c(4, 14))+
ggtitle("DHS Clusters")+
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank(),
legend.title = element_text(size = 14),
legend.text = element_text(size = 10),
plot.title = element_text(hjust = 0.5, size = 24))
View(total_age_df)
child_geo_sum <- Child_geo%>%
group_by(Age, uniqueGeo)%>%
summarise(meanTet = mean(tet, na.rm = TRUE),
TetSero = sum(tet_bin),
meanRub = mean(ruv, na.rm = TRUE),
RubSero = sum(ruv_bin),
meanMea = mean(mev),
MeaSero = sum(mev_bin),
meanDip = mean(dip),
DipSero = sum(dip_bin),
ageCount = n())%>%
mutate(TetSeroPercentage = TetSero/ageCount)%>%
mutate(RubSeroPercentage = RubSero/ageCount)%>%
mutate(MeaSeroPercentage = MeaSero/ageCount)%>%
mutate(DipSeroPercentage = DipSero/ageCount)%>%
mutate(age_under25 = ifelse(Age <25 , 0, 1))
total_age_df <- rbind(child_geo_sum, mother_geo_sum_1)
LATLONG <- stringr::str_split(total_age_df$uniqueGeo, boundary("word"))
LATNUM <- c()
LONGNUM <- c()
for(i in 1:length(LATLONG)){
LATNUM[i] <-LATLONG[[i]][1]
LONGNUM[i] <- LATLONG[[i]][2]
}
total_age_df$LATNUM <- as.numeric(LATNUM)
total_age_df$LONGNUM <- as.numeric(LONGNUM)
total_age_df <- total_age_df%>%
filter(!is.na(LONGNUM))%>%
mutate(X= LONGNUM)%>%
mutate(Y=LATNUM)%>%
dplyr::select(-LONGNUM, -LATNUM)
total_age_df_sf <- st_as_sf(total_age_df, coords = c("X", "Y"), crs = "+proj=longlat +datum=WGS84 +no_defs")
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = total_age_df_sf)
ggplot()+
geom_polygon(data = nigeria_polygon_sp, aes(x=long, y=lat, z=group), colour="gray40", fill=NA, cex=0.25)+
geom_sf(data = total_age_df_sf)+
ggtitle("CDC Clusters")+
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank(),
legend.title = element_text(size = 14),
legend.text = element_text(size = 10),
plot.title = element_text(hjust = 0.5, size = 24))
View(total_age_df)
